name: aws
runtime: nodejs20.x
httpApi:
  cors:
    allowedOrigins:
      - '*'
    allowedHeaders:
      - Content-Type
      - Authorization
    allowedMethods:
      - OPTIONS
      - GET
      - POST
      - PUT
      - DELETE

iam:
  role:
    statements:
      - Effect: Allow
        Action:
          - dynamodb:Query
          - dynamodb:Scan
          - dynamodb:GetItem
          - dynamodb:PutItem
          - dynamodb:UpdateItem
          - dynamodb:DeleteItem
        Resource:
          - Fn::GetAtt: [ OrdersTable, Arn ]
environment:
  ORDERS_TABLE: ${self:custom.tableName}